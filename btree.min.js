/**
 * BehaviorTree.js
 * https://github.com/Calamari/BehaviorTree.js
 *
 * Copyright 2013, Georg Tavonius
 * Licensed under the MIT license.
 *
 * Version: 0.9.2
 */
(function(e){"use strict";function n(e){t+=1,this.title=e.title||"btree"+t,this._rootNode=e.tree,this._object=e.object}var t=0;n.prototype.setObject=function(e){this._object=e},n.prototype.step=function(){if(this._started)return;this._started=!0;var e=n.getNode(this._rootNode);this._actualNode=e,e.setControl(this),e.start(this._object),e.run(this._object)},n.prototype.running=function(){this._started=!1},n.prototype.success=function(){this._actualNode.end(this._object),this._started=!1},n.prototype.fail=function(){this._actualNode.end(this._object),this._started=!1};var r={};n.register=function(e,t){typeof e=="string"?r[e]=t:r[e.title]=e},n.getNode=function(e){var t=e instanceof n.Node?e:r[e];return t||console.log('The node "'+e+'" could not be looked up. Maybe it was never registered?'),t},e.BehaviorTree=n})(this),function(e){"use strict";var t=function(e){e=e||{},this.title=e.title,e.nodes&&(this.nodes=e.nodes),e.success&&(this.success=e.success),e.fail&&(this.fail=e.fail),e.running&&(this.running=e.running),e.start&&(this.start=e.start),e.end&&(this.end=e.end),e.run&&(this.run=e.run)};t.prototype.start=function(){},t.prototype.end=function(){},t.prototype.run=function(){console.log("Warning: run of "+this.title+" not implemented!"),this.fail()},t.prototype.setControl=function(e){this._control=e},t.prototype.running=function(){this._control.running(this)},t.prototype.success=function(){this._control.success()},t.prototype.fail=function(){this._control.fail()},e.Node=t,"use strict";var n=function(t){e.Node.call(this,t)};n.prototype=new e.Node,n.prototype.start=function(){this._actualTask=0},n.prototype.run=function(e){this._object=e,this.start(),this._actualTask<this.nodes.length&&this._run(),this.end()},n.prototype._run=function(){var t=e.getNode(this.nodes[this._actualTask]);this._runningNode=t,t.setControl(this),t.start(this._object),t.run(this._object)},n.prototype.running=function(e){this._nodeRunning=e,this._control.running(e)},n.prototype.success=function(){this._nodeRunning=null,this._runningNode.end(this._object),this._runningNode=null},n.prototype.fail=function(){this._nodeRunning=null,this._runningNode.end(this._object),this._runningNode=null},e.BranchNode=n,"use strict";var r=function(t){e.BranchNode.call(this,t)};r.prototype=new e.BranchNode,r.prototype.success=function(){e.BranchNode.prototype.success.apply(this,arguments),this._control.success()},r.prototype.fail=function(){e.BranchNode.prototype.fail.apply(this,arguments),this._actualTask+=1,this._actualTask<this.nodes.length?this._run(this._object):this._control.fail()},e.Priority=r,"use strict";var i=function(t){e.BranchNode.call(this,t)};i.prototype=new e.BranchNode,i.prototype._run=function(){this._nodeRunning?(this._nodeRunning.run(this._object),this._nodeRunning=null):e.BranchNode.prototype._run.apply(this,arguments)},i.prototype.success=function(){e.BranchNode.prototype.success.apply(this,arguments),this._actualTask+=1,this._actualTask<this.nodes.length?this._run(this._object):this._control.success()},i.prototype.fail=function(){e.BranchNode.prototype.fail.apply(this,arguments),this._control.fail()},e.Sequence=i,"use strict";var s=function(t){e.BranchNode.call(this,t)};s.prototype=new e.BranchNode,s.prototype.start=function(){e.BranchNode.prototype.start.apply(this,arguments),this._nodeRunning||(this._actualTask=Math.floor(Math.random()*this.nodes.length))},s.prototype._run=function(){this._runningNode?this._runningNode.run(this._object):e.BranchNode.prototype._run.call(this)},s.prototype.success=function(){e.BranchNode.prototype.success.apply(this,arguments),this._control.success()},s.prototype.fail=function(){e.BranchNode.prototype.fail.apply(this,arguments),this._control.fail()},e.Random=s,"use strict",e.Task=e.Node,"use strict";var o=function(t){t=t||{},e.Node.call(this,t),t.node&&(this.node=BehaviorTree.getNode(t.node))};o.prototype=new e.Node,o.prototype.setNode=function(e){this.node=BehaviorTree.getNode(e)},o.prototype.start=function(){this.node.setControl(this),this.node.start()},o.prototype.end=function(){this.node.end()},o.prototype.run=function(e){this.node.run(e)},e.Decorator=o,"use strict";var u=function(t){e.Decorator.call(this,t)};u.prototype=new e.Decorator,u.prototype.success=function(){this._control.fail()},u.prototype.fail=function(){this._control.success()},e.InvertDecorator=u,"use strict";var a=function(t){e.Decorator.call(this,t)};a.prototype=new e.Decorator,a.prototype.success=function(){this._control.success()},a.prototype.fail=function(){this._control.success()},e.AlwaysSucceedDecorator=a,"use strict";var f=function(t){e.Decorator.call(this,t)};f.prototype=new e.Decorator,f.prototype.success=function(){this._control.fail()},f.prototype.fail=function(){this._control.fail()},e.AlwaysFailDecorator=f}(BehaviorTree);